"use strict";
var $__fs__,
    $__events__,
    $__raspi_45_core__,
    $__raspi_45_board__,
    $__raspi_45_gpio__,
    $__raspi_45_pwm__;
var fs = ($__fs__ = require("fs"), $__fs__ && $__fs__.__esModule && $__fs__ || {default: $__fs__}).default;
var events = ($__events__ = require("events"), $__events__ && $__events__.__esModule && $__events__ || {default: $__events__}).default;
var init = ($__raspi_45_core__ = require("raspi-core"), $__raspi_45_core__ && $__raspi_45_core__.__esModule && $__raspi_45_core__ || {default: $__raspi_45_core__}).init;
var $__3 = ($__raspi_45_board__ = require("raspi-board"), $__raspi_45_board__ && $__raspi_45_board__.__esModule && $__raspi_45_board__ || {default: $__raspi_45_board__}),
    getPins = $__3.getPins,
    getPinNumber = $__3.getPinNumber;
var $__4 = ($__raspi_45_gpio__ = require("raspi-gpio"), $__raspi_45_gpio__ && $__raspi_45_gpio__.__esModule && $__raspi_45_gpio__ || {default: $__raspi_45_gpio__}),
    DigitalOutput = $__4.DigitalOutput,
    DigitalInput = $__4.DigitalInput;
var PWM = ($__raspi_45_pwm__ = require("raspi-pwm"), $__raspi_45_pwm__ && $__raspi_45_pwm__.__esModule && $__raspi_45_pwm__ || {default: $__raspi_45_pwm__}).PWM;
if (process.env.USER != 'root') {
  console.warn('WARNING: Raspi-IO usually needs to be run with root privileges to access hardware, but it doesn\'t appear to be running as root currently');
}
var INPUT = 0;
var OUTPUT = 1;
var ANALOG = 2;
var PWM = 3;
var SERVO = 4;
var LOW = 0;
var HIGH = 1;
var LED = 'led0';
var isReady = '__r$271828_0$__';
var pins = '__r$271828_1$__';
var instances = '__r$271828_2$__';
var analogPins = '__r$271828_3$__';
var mode = '__$271828_4$__';
var Raspi = function Raspi() {
  var $__8;
  var $__6 = this;
  $traceurRuntime.superCall(this, $Raspi.prototype, "constructor", []);
  Object.defineProperties(this, ($__8 = {}, Object.defineProperty($__8, "name", {
    value: {
      enumerable: true,
      value: 'RaspberryPi-IO'
    },
    configurable: true,
    enumerable: true,
    writable: true
  }), Object.defineProperty($__8, instances, {
    value: {
      writable: true,
      value: []
    },
    configurable: true,
    enumerable: true,
    writable: true
  }), Object.defineProperty($__8, isReady, {
    value: {
      writable: true,
      value: false
    },
    configurable: true,
    enumerable: true,
    writable: true
  }), Object.defineProperty($__8, "isReady", {
    value: {
      enumerable: true,
      get: (function() {
        return $__6[isReady];
      })
    },
    configurable: true,
    enumerable: true,
    writable: true
  }), Object.defineProperty($__8, pins, {
    value: {
      writable: true,
      value: []
    },
    configurable: true,
    enumerable: true,
    writable: true
  }), Object.defineProperty($__8, "pins", {
    value: {
      enumerable: true,
      get: (function() {
        return $__6[pins];
      })
    },
    configurable: true,
    enumerable: true,
    writable: true
  }), Object.defineProperty($__8, analogPins, {
    value: {
      writable: true,
      value: []
    },
    configurable: true,
    enumerable: true,
    writable: true
  }), Object.defineProperty($__8, "analogPins", {
    value: {
      enumerable: true,
      get: (function() {
        return $__6[analogPins];
      })
    },
    configurable: true,
    enumerable: true,
    writable: true
  }), Object.defineProperty($__8, "MODES", {
    value: {
      enumerable: true,
      value: Object.freeze({
        INPUT: INPUT,
        OUTPUT: OUTPUT,
        ANALOG: ANALOG,
        PWM: PWM,
        SERVO: SERVO
      })
    },
    configurable: true,
    enumerable: true,
    writable: true
  }), Object.defineProperty($__8, "HIGH", {
    value: {
      enumerable: true,
      value: HIGH
    },
    configurable: true,
    enumerable: true,
    writable: true
  }), Object.defineProperty($__8, "LOW", {
    value: {
      enumerable: true,
      value: LOW
    },
    configurable: true,
    enumerable: true,
    writable: true
  }), Object.defineProperty($__8, "defaultLed", {
    value: {
      enumerable: true,
      value: LED
    },
    configurable: true,
    enumerable: true,
    writable: true
  }), $__8));
  init((function() {
    var pinMappings = getPins();
    $__6[pins] = (Object.keys(pinMappings).map((function(pin) {
      pin = pinMappings[pin];
      var supportedModes = [INPUT, OUTPUT];
      if (pin.peripherals.indexOf('pwm') != -1) {
        supportedModes.push(PWM, SERVO);
      }
      var value = ($__6[instances][pin] = new DigitalInput(pin)).read();
      return Object.create(null, {
        supportedModes: {
          enumerable: true,
          value: Object.freeze(supportedModes)
        },
        mode: {
          enumerable: true,
          value: INPUT
        },
        value: {
          enumerable: true,
          value: value
        },
        report: {
          enumerable: true,
          value: 1
        },
        analogChannel: {
          enumerable: true,
          value: 127
        }
      });
    })));
    $__6.emit('ready');
    $__6.emit('connect');
  }));
};
var $Raspi = Raspi;
($traceurRuntime.createClass)(Raspi, {
  reset: function() {
    throw 'reset is not yet implemented.';
  },
  normalize: function(pin) {
    return getPinNumber(pin);
  }
}, {}, events.EventEmitter);
Object.defineProperty(Raspi, 'isRaspberryPi', {
  enumerable: true,
  value: (function() {
    var isRaspberryPi = false;
    try {
      isRaspberryPi = fs.readFileSync('/etc/os-release').toString().indexOf('Raspbian') !== -1;
    } catch (e) {}
    return isRaspberryPi;
  })
});
module.exports = Raspi;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIiwiQHRyYWNldXIvZ2VuZXJhdGVkL1RlbXBsYXRlUGFyc2VyLzAiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvMyIsIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci8yIiwiQHRyYWNldXIvZ2VuZXJhdGVkL1RlbXBsYXRlUGFyc2VyLzUiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvNCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUF5QkE7Ozs7Ozs7RUFBTyxHQUFDLEVDekJSLEVBQUMsU0FBb0IsQ0FBQSxPQUFNLEFBQUMsTUFBa0IsQ0FDdEMsQ0FBQSxVQUFxQixtQkFBMkIsQ0FBQSxVQUFxQixHQUFLLEVBQUMsT0FBTSxTQUFtQixDQUQ5RCxBQUMrRCxDQUFDO0VEeUJ2RyxPQUFLLEVDMUJaLEVBQUMsYUFBb0IsQ0FBQSxPQUFNLEFBQUMsVUFBa0IsQ0FDdEMsQ0FBQSxjQUFxQix1QkFBMkIsQ0FBQSxjQUFxQixHQUFLLEVBQUMsT0FBTSxhQUFtQixDQUQ5RCxBQUMrRCxDQUFDO0VEMEJyRyxLQUFHLEVDM0JaLEVBQUMsb0JBQW9CLENBQUEsT0FBTSxBQUFDLGNBQWtCLENBQ3RDLENBQUEscUJBQXFCLDhCQUEyQixDQUFBLHFCQUFxQixHQUFLLEVBQUMsT0FBTSxvQkFBbUIsQ0FEOUQsQUFDK0QsQ0FBQztTQUQ5RyxFQUFDLHFCQUFvQixDQUFBLE9BQU0sQUFBQyxlQUFrQixDQUN0QyxDQUFBLHNCQUFxQiwrQkFBMkIsQ0FBQSxzQkFBcUIsR0FBSyxFQUFDLE9BQU0scUJBQW1CLENBRDlELEFBQytELENBQUM7QUQyQnJHLFVBQU07QUFBRyxlQUFXO1NDNUI3QixFQUFDLG9CQUFvQixDQUFBLE9BQU0sQUFBQyxjQUFrQixDQUN0QyxDQUFBLHFCQUFxQiw4QkFBMkIsQ0FBQSxxQkFBcUIsR0FBSyxFQUFDLE9BQU0sb0JBQW1CLENBRDlELEFBQytELENBQUM7QUQ0QnJHLGdCQUFZO0FB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LEtBQUssUUFBUSxFQUFJLE1BQUksQ0FBQztBQWtJdEIiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuQ29weXJpZ2h0IChjKSAyMDE0IEJyeWFuIEh1Z2hlcyA8YnJ5YW5AdGhlb3JldGljYWxpZGVhdGlvbnMuY29tPlxuXG5QZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvblxub2J0YWluaW5nIGEgY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb25cbmZpbGVzICh0aGUgJ1NvZnR3YXJlJyksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXRcbnJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLFxuY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbmNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZVxuU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmdcbmNvbmRpdGlvbnM6XG5cblRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlXG5pbmNsdWRlZCBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cblxuVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICdBUyBJUycsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsXG5FWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVNcbk9GIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EXG5OT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVFxuSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksXG5XSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkdcbkZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1Jcbk9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cbiovXG5cbmltcG9ydCBmcyBmcm9tICdmcyc7XG5pbXBvcnQgZXZlbnRzIGZyb20gJ2V2ZW50cyc7XG5pbXBvcnQgeyBpbml0IH0gZnJvbSAncmFzcGktY29yZSc7XG5pbXBvcnQgeyBnZXRQaW5zLCBnZXRQaW5OdW1iZXIgfSBmcm9tICdyYXNwaS1ib2FyZCc7XG5pbXBvcnQgeyBEaWdpdGFsT3V0cHV0LCBEaWdpdGFsSW5wdXQgfSBmcm9tICdyYXNwaS1ncGlvJztcbmltcG9ydCB7IFBXTSB9IGZyb20gJ3Jhc3BpLXB3bSc7XG5cbi8vIENoZWNrIGZvciByb290IGFjY2Vzc1xuaWYgKHByb2Nlc3MuZW52LlVTRVIgIT0gJ3Jvb3QnKSB7XG4gIGNvbnNvbGUud2FybignV0FSTklORzogUmFzcGktSU8gdXN1YWxseSBuZWVkcyB0byBiZSBydW4gd2l0aCByb290IHByaXZpbGVnZXMgdG8gYWNjZXNzIGhhcmR3YXJlLCBidXQgaXQgZG9lc25cXCd0IGFwcGVhciB0byBiZSBydW5uaW5nIGFzIHJvb3QgY3VycmVudGx5Jyk7XG59XG5cbi8vIENvbnN0YW50c1xudmFyIElOUFVUID0gMDtcbnZhciBPVVRQVVQgPSAxO1xudmFyIEFOQUxPRyA9IDI7XG52YXIgUFdNID0gMztcbnZhciBTRVJWTyA9IDQ7XG5cbnZhciBMT1cgPSAwO1xudmFyIEhJR0ggPSAxO1xuXG52YXIgTEVEID0gJ2xlZDAnO1xuXG4vLyBIYWNreSBidXQgZmFzdCBlbXVsYXRpb24gb2Ygc3ltYm9scywgZWxpbWluYXRpbmcgdGhlIG5lZWQgZm9yICR0cmFjZXVyUnVudGltZS50b1Byb3BlcnR5IGNhbGxzXG52YXIgaXNSZWFkeSA9ICdfX3IkMjcxODI4XzAkX18nO1xudmFyIHBpbnMgPSAnX19yJDI3MTgyOF8xJF9fJztcbnZhciBpbnN0YW5jZXMgPSAnX19yJDI3MTgyOF8yJF9fJztcbnZhciBhbmFsb2dQaW5zID0gJ19fciQyNzE4MjhfMyRfXyc7XG52YXIgbW9kZSA9ICdfXyQyNzE4MjhfNCRfXyc7XG5cbmNsYXNzIFJhc3BpIGV4dGVuZHMgZXZlbnRzLkV2ZW50RW1pdHRlciB7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKTtcblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRoaXMsIHtcbiAgICAgIG5hbWU6IHtcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgdmFsdWU6ICdSYXNwYmVycnlQaS1JTydcbiAgICAgIH0sXG5cbiAgICAgIFtpbnN0YW5jZXNdOiB7XG4gICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICB2YWx1ZTogW11cbiAgICAgIH0sXG5cbiAgICAgIFtpc1JlYWR5XToge1xuICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgdmFsdWU6IGZhbHNlXG4gICAgICB9LFxuICAgICAgaXNSZWFkeToge1xuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBnZXQ6ICgpID0+IHtcbiAgICAgICAgICByZXR1cm4gdGhpc1tpc1JlYWR5XTtcbiAgICAgICAgfVxuICAgICAgfSxcblxuICAgICAgW3BpbnNdOiB7XG4gICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICB2YWx1ZTogW11cbiAgICAgIH0sXG4gICAgICBwaW5zOiB7XG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGdldDogKCkgPT4ge1xuICAgICAgICAgIHJldHVybiB0aGlzW3BpbnNdO1xuICAgICAgICB9XG4gICAgICB9LFxuXG4gICAgICBbYW5hbG9nUGluc106IHtcbiAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgIHZhbHVlOiBbXVxuICAgICAgfSxcbiAgICAgIGFuYWxvZ1BpbnM6IHtcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgZ2V0OiAoKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIHRoaXNbYW5hbG9nUGluc107XG4gICAgICAgIH1cbiAgICAgIH0sXG5cbiAgICAgIE1PREVTOiB7XG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIHZhbHVlOiBPYmplY3QuZnJlZXplKHtcbiAgICAgICAgICBJTlBVVDogSU5QVVQsXG4gICAgICAgICAgT1VUUFVUOiBPVVRQVVQsXG4gICAgICAgICAgQU5BTE9HOiBBTkFMT0csXG4gICAgICAgICAgUFdNOiBQV00sXG4gICAgICAgICAgU0VSVk86IFNFUlZPXG4gICAgICAgIH0pXG4gICAgICB9LFxuXG4gICAgICBISUdIOiB7XG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIHZhbHVlOiBISUdIXG4gICAgICB9LFxuICAgICAgTE9XOiB7XG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIHZhbHVlOiBMT1dcbiAgICAgIH0sXG5cbiAgICAgIGRlZmF1bHRMZWQ6IHtcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgdmFsdWU6IExFRFxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaW5pdCgoKSA9PiB7XG4gICAgICB2YXIgcGluTWFwcGluZ3MgPSBnZXRQaW5zKCk7XG4gICAgICB0aGlzW3BpbnNdID0gKE9iamVjdC5rZXlzKHBpbk1hcHBpbmdzKS5tYXAoKHBpbikgPT4ge1xuICAgICAgICBwaW4gPSBwaW5NYXBwaW5nc1twaW5dO1xuICAgICAgICB2YXIgc3VwcG9ydGVkTW9kZXMgPSBbIElOUFVULCBPVVRQVVQgXTtcbiAgICAgICAgaWYgKHBpbi5wZXJpcGhlcmFscy5pbmRleE9mKCdwd20nKSAhPSAtMSkge1xuICAgICAgICAgIHN1cHBvcnRlZE1vZGVzLnB1c2goUFdNLCBTRVJWTyk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHZhbHVlID0gKHRoaXNbaW5zdGFuY2VzXVtwaW5dID0gbmV3IERpZ2l0YWxJbnB1dChwaW4pKS5yZWFkKCk7XG4gICAgICAgIHJldHVybiBPYmplY3QuY3JlYXRlKG51bGwsIHtcbiAgICAgICAgICBzdXBwb3J0ZWRNb2Rlczoge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBPYmplY3QuZnJlZXplKHN1cHBvcnRlZE1vZGVzKVxuICAgICAgICAgIH0sXG4gICAgICAgICAgbW9kZToge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiBJTlBVVFxuICAgICAgICAgIH0sXG4gICAgICAgICAgdmFsdWU6IHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICB2YWx1ZTogdmFsdWVcbiAgICAgICAgICB9LFxuICAgICAgICAgIHJlcG9ydDoge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIHZhbHVlOiAxXG4gICAgICAgICAgfSxcbiAgICAgICAgICBhbmFsb2dDaGFubmVsOiB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgdmFsdWU6IDEyN1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KSk7XG4gICAgICB0aGlzLmVtaXQoJ3JlYWR5Jyk7XG4gICAgICB0aGlzLmVtaXQoJ2Nvbm5lY3QnKTtcbiAgICB9KTtcbiAgfVxuXG4gIHJlc2V0KCkge1xuICAgIHRocm93ICdyZXNldCBpcyBub3QgeWV0IGltcGxlbWVudGVkLic7XG4gIH1cblxuICBub3JtYWxpemUocGluKSB7XG4gICAgcmV0dXJuIGdldFBpbk51bWJlcihwaW4pO1xuICB9XG59XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShSYXNwaSwgJ2lzUmFzcGJlcnJ5UGknLCB7XG4gIGVudW1lcmFibGU6IHRydWUsXG4gIHZhbHVlOiAoKSA9PiB7XG4gICAgLy8gRGV0ZXJtaW5pbmcgaWYgYSBzeXN0ZW0gaXMgYSBSYXNwYmVycnkgUGkgaXNuJ3QgcG9zc2libGUgdGhyb3VnaFxuICAgIC8vIHRoZSBvcyBtb2R1bGUgb24gUmFzcGJpYW4sIHNvIHdlIHJlYWQgaXQgZnJvbSB0aGUgZmlsZSBzeXN0ZW0gaW5zdGVhZFxuICAgIHZhciBpc1Jhc3BiZXJyeVBpID0gZmFsc2U7XG4gICAgdHJ5IHtcbiAgICAgIGlzUmFzcGJlcnJ5UGkgPSBmcy5yZWFkRmlsZVN5bmMoJy9ldGMvb3MtcmVsZWFzZScpLnRvU3RyaW5nKCkuaW5kZXhPZignUmFzcGJpYW4nKSAhPT0gLTE7XG4gICAgfSBjYXRjaChlKSB7fS8vIFNxdWFzaCBmaWxlIG5vdCBmb3VuZCwgZXRjIGVycm9yc1xuICAgIHJldHVybiBpc1Jhc3BiZXJyeVBpO1xuICB9XG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBSYXNwaTtcblxuLypmdW5jdGlvbiBSYXNwaSgpIHtcbiAgLy8gSW5pdGlhbGl6ZSB0aGUgR1BJTyBwaW5zXG4gIEJvYXJkLmdldEJvYXJkUGlucygoZnVuY3Rpb24gKGVyciwgcGlucywgcGluQWxpYXNlcykge1xuICAgIGlmIChlcnIpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0NvdWxkIG5vdCBpbml0aWFsaXplIGJvYXJkOiAnICsgZXJyKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5waW5zID0gcGlucztcbiAgICB0aGlzLl9waW5BbGlhc2VzID0gcGluQWxpYXNlcztcblxuICAgIC8vIEhlbHBlciBtZXRob2QgdG8gaW5pdGlhbGl6ZSBhIHBpbiBpbnN0YW5jZVxuICAgIHZhciBjcmVhdGVQaW5Jbml0aWFsaXplciA9IChmdW5jdGlvbiBjcmVhdGVQaW5Jbml0aWFsaXplcihkZXNjcmlwdG9yKSB7XG4gICAgICByZXR1cm4gKGZ1bmN0aW9uKG5leHQpIHtcbiAgICAgICAgKGRlc2NyaXB0b3IuX2luc3RhbmNlID0gbmV3IEdQSU8oZGVzY3JpcHRvci5fZ3BpbykpLmluaXQoZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgbmV4dCgnQ291bGQgbm90IGluaXRpYWxpemUgR1BJTyAnICsgZGVzY3JpcHRvci5fZ3BpbyArICc6ICcgKyBlcnIpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBuZXh0KCk7XG4gICAgICAgICAgfVxuICAgICAgICB9LCB0aGlzKTtcbiAgICAgIH0pLmJpbmQodGhpcyk7XG4gICAgfSkuYmluZCh0aGlzKTtcblxuICAgIC8vIEluaXRpYWxpemUgdGhlIHBpbnNcbiAgICB2YXIgdGFza3MgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gcGlucy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgaWYgKHBpbnNbaV0uc3VwcG9ydGVkTW9kZXMubGVuZ3RoKSB7XG4gICAgICAgIHRhc2tzLnB1c2goY3JlYXRlUGluSW5pdGlhbGl6ZXIocGluc1tpXSkpO1xuICAgICAgfVxuICAgIH1cbiAgICBhc3luYy5wYXJhbGxlbCh0YXNrcywgKGZ1bmN0aW9uKGVycikge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdDb3VsZCBub3QgaW5pdGlhbGl6ZSBHUElPIHBpbnM6ICcgKyBlcnIpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLmlzUmVhZHkgPSB0cnVlO1xuICAgICAgdGhpcy5lbWl0KCdyZWFkeScpO1xuICAgICAgdGhpcy5lbWl0KCdjb25uZWN0Jyk7XG4gICAgfSkuYmluZCh0aGlzKSk7XG4gIH0pLmJpbmQodGhpcykpO1xufVxuUmFzcGkucHJvdG90eXBlID0gbmV3IEVtaXR0ZXIoKTtcblxuUmFzcGkucmVzZXQgPSBmdW5jdGlvbigpIHtcbiAgdGhyb3cgJ3Jlc2V0IGlzIG5vdCB5ZXQgaW1wbGVtZW50ZWQuJztcbn07XG5cblJhc3BpLmlzUmFzcGJlcnJ5UGkgPSBmdW5jdGlvbiAoKSB7XG4gIC8vIERldGVybWluaW5nIGlmIGEgc3lzdGVtIGlzIGEgUmFzcGJlcnJ5IFBpIGlzbid0IHBvc3NpYmxlIHRocm91Z2hcbiAgLy8gdGhlIG9zIG1vZHVsZSBvbiBSYXNwYmlhbiwgc28gd2UgcmVhZCBpdCBmcm9tIHRoZSBmaWxlIHN5c3RlbSBpbnN0ZWFkXG4gIHZhciBpc1Jhc3BiZXJyeVBpID0gZmFsc2U7XG4gIHRyeSB7XG4gICAgaXNSYXNwYmVycnlQaSA9IGZzLnJlYWRGaWxlU3luYygnL2V0Yy9vcy1yZWxlYXNlJykudG9TdHJpbmcoKS5pbmRleE9mKCdSYXNwYmlhbicpICE9PSAtMTtcbiAgfSBjYXRjaChlKSB7fS8vIFNxdWFzaCBmaWxlIG5vdCBmb3VuZCwgZXRjIGVycm9yc1xuICByZXR1cm4gaXNSYXNwYmVycnlQaTtcbn07XG5cblJhc3BpLnByb3RvdHlwZS5ub3JtYWxpemUgPSBmdW5jdGlvbihhbGlhcykge1xuICByZXR1cm4gdGhpcy5fcGluQWxpYXNlc1thbGlhcy50b1N0cmluZygpLnRvVXBwZXJDYXNlKCldIHx8IGFsaWFzO1xufTtcblxuUmFzcGkucHJvdG90eXBlLnBpbk1vZGUgPSBmdW5jdGlvbihwaW4sIG1vZGUpIHtcbiAgdmFyIHBpbkluc3RhbmNlID0gdGhpcy5waW5zW3Bpbl07XG4gIGlmICghcGluSW5zdGFuY2UpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgcGluIFwiJyArIHBpbiArICdcIicpO1xuICB9IGVsc2UgaWYgKHBpbkluc3RhbmNlLnN1cHBvcnRlZE1vZGVzLmluZGV4T2YobW9kZSkgPT0gLTEpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1BpbiBcIicgKyBwaW4gKyAnXCIgZG9lcyBub3Qgc3VwcG9ydCBtb2RlIFwiJyArIG1vZGUgKyAnXCInKTtcbiAgfVxuXG4gIC8vIEZvciBub3cgd2Ugb25seSBzdXBwb3J0IEdQSU8sIGFrYSBJTlBVVCBhbmQgT1VUUFVULiBUaGlzIHdpbGwgbmVlZCB0byBiZSByZWZhY3RvcmVkXG4gIC8vIGxhdGVyIG9uY2Ugb3RoZXIgdHlwZXMgb2YgbW9kZXMgYXJlIHN1cHBvcnRlZFxuICBwaW5JbnN0YW5jZS5tb2RlID0gbW9kZTtcbiAgcGluSW5zdGFuY2UuX2luc3RhbmNlLnNldERpcmVjdGlvblN5bmMobW9kZSA9PSBCb2FyZC5tb2Rlcy5PVVRQVVQgPyAnb3V0JyA6ICdpbicpO1xufTtcblxuUmFzcGkucHJvdG90eXBlLmRpZ2l0YWxSZWFkID0gZnVuY3Rpb24ocGluLCBoYW5kbGVyKSB7XG4gIHZhciBwaW5JbnN0YW5jZSA9IHRoaXMucGluc1twaW5dO1xuICBpZiAoIXBpbkluc3RhbmNlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHBpbiBcIicgKyBwaW4gKyAnXCInKTtcbiAgfVxuICBwaW5JbnN0YW5jZS5faW5zdGFuY2Uud2F0Y2hWYWx1ZShoYW5kbGVyKTtcbn07XG5cblJhc3BpLnByb3RvdHlwZS5kaWdpdGFsV3JpdGUgPSBmdW5jdGlvbihwaW4sIHZhbHVlKSB7XG4gIHZhciBwaW5JbnN0YW5jZSA9IHRoaXMucGluc1twaW5dO1xuICBpZiAoIXBpbkluc3RhbmNlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHBpbiBcIicgKyBwaW4gKyAnXCInKTtcbiAgfSBlbHNlIGlmIChwaW5JbnN0YW5jZS5tb2RlICE9PSBCb2FyZC5tb2Rlcy5PVVRQVVQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCB3cml0ZSB0byBwaW4gXCInICsgcGluICsgJ1wiIGJlY2F1c2UgaXQgaXMgbm90IGluIG91dHB1dCBtb2RlJyk7XG4gIH1cbiAgcGluSW5zdGFuY2UuX2luc3RhbmNlLndyaXRlVmFsdWVTeW5jKHZhbHVlKTtcbn07XG5cblJhc3BpLnByb3RvdHlwZS5hbmFsb2dSZWFkID0gZnVuY3Rpb24oKSB7XG4gIHRocm93IG5ldyBFcnJvcignQW5hbG9nIHJlYWQgaXMgbm90IHN1cHBvcnRlZCBvbiB0aGUgUmFzcGJlcnJ5IFBpJyk7XG59O1xuXG5SYXNwaS5wcm90b3R5cGUuYW5hbG9nV3JpdGUgPSBmdW5jdGlvbigpIHtcbiAgdGhyb3cgbmV3IEVycm9yKCdBbmFsb2cgd3JpdGUgaXMgbm90IHN1cHBvcnRlZCBvbiB0aGUgUmFzcGJlcnJ5IFBpJyk7XG59O1xuXG5bXG4gICdzZXJ2b1dyaXRlJyxcbiAgJ3B1bHNlSW4nLFxuICAncHVsc2VPdXQnLFxuICAncXVlcnlQaW5TdGF0ZScsXG4gICdzZW5kSTJDV3JpdGVSZXF1ZXN0JyxcbiAgJ3NlbmRJMkNSZWFkUmVxdWVzdCcsXG4gICdzZW5kSTJDQ29uZmlnJyxcbiAgJ19zZW5kT25lV2lyZVJlcXVlc3QnLFxuICAnX3NlbmRPbmVXaXJlU2VhcmNoJyxcbiAgJ3NlbmRPbmVXaXJlV3JpdGVBbmRSZWFkJyxcbiAgJ3NlbmRPbmVXaXJlRGVsYXknLFxuICAnc2VuZE9uZVdpcmVEZWxheScsXG4gICdzZW5kT25lV2lyZVJlc2V0JyxcbiAgJ3NlbmRPbmVXaXJlUmVhZCcsXG4gICdzZW5kT25lV2lyZVNlYXJjaCcsXG4gICdzZW5kT25lV2lyZUFsYXJtc1NlYXJjaCcsXG4gICdzZW5kT25lV2lyZUNvbmZpZycsXG4gICdzdGVwcGVyQ29uZmlnJyxcbiAgJ3N0ZXBwZXJTdGVwJ1xuXS5mb3JFYWNoKGZ1bmN0aW9uKG1ldGhvZCkge1xuICBSYXNwaS5wcm90b3R5cGVbbWV0aG9kXSA9IGZ1bmN0aW9uKCkge1xuICAgIHRocm93IG1ldGhvZCArICcgaXMgbm90IHlldCBpbXBsZW1lbnRlZC4nO1xuICB9O1xufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gUmFzcGk7Ki9cbiIsIigkX19wbGFjZWhvbGRlcl9fMCA9IHJlcXVpcmUoJF9fcGxhY2Vob2xkZXJfXzEpLCBcbiAgICAgICAgJF9fcGxhY2Vob2xkZXJfXzIgJiYgJF9fcGxhY2Vob2xkZXJfXzMuX19lc01vZHVsZSAmJiAkX19wbGFjZWhvbGRlcl9fNCB8fCB7ZGVmYXVsdDogJF9fcGxhY2Vob2xkZXJfXzV9KSIsInZhciAkX19wbGFjZWhvbGRlcl9fMCA9ICRfX3BsYWNlaG9sZGVyX18xIiwiJHRyYWNldXJSdW50aW1lLnN1cGVyQ2FsbCgkX19wbGFjZWhvbGRlcl9fMCwgJF9fcGxhY2Vob2xkZXJfXzEsICRfX3BsYWNlaG9sZGVyX18yLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkX19wbGFjZWhvbGRlcl9fMykiLCJ2YXIgJF9fcGxhY2Vob2xkZXJfXzAgPSAkX19wbGFjZWhvbGRlcl9fMSIsIigkdHJhY2V1clJ1bnRpbWUuY3JlYXRlQ2xhc3MpKCRfX3BsYWNlaG9sZGVyX18wLCAkX19wbGFjZWhvbGRlcl9fMSwgJF9fcGxhY2Vob2xkZXJfXzIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkX19wbGFjZWhvbGRlcl9fMykiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=